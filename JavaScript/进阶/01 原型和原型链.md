[toc]

# 原型和原型链

## 原型

在JavaScript中，每个函数(除箭头函数外)都有特殊的prototype属性，他是一个对象，被称为**原型对象**。当使用`new`关键字创建一个实例时，该实例内部会有一个隐藏的[[Prototype]]链接(可通过\_\_proto\_\_属性访问)，这个链接指向其构造函数的prototype对象。

原型的主要作用时实现**属性继承**，当试图访问一个实例的属性时，如果实例本身没有这个属性，JavaScript引擎会自动去它的原型对象上查找。

* 类和函数 –> prototype
* 实例 –> \_\_proto\_\_

> [!tip]
>
> 当一个普通函数被创建时，他会自动获得一个`prototype`属性。这个属性的值是一个普通对象，这个对象默认只有一个属性：constructor 指向函数本身
>
> 他的作用是：当通过new创建实例时，该实例可以通过\_\_proto\_\_来访问`Person.prototype`对象。这样所有实例都能访问添加到`Person.prototype`上的方法，实现了方法的共享，节省内存。
>
> `ClassName.prototype.constructor === ClassName`为 `true`

类(class)是ES6引入的语法糖，其底层依然是基于原型的机制。因此，类也会自动获得一个prototype属性。

类的prototype属性上的方法默认是**不可枚举的**，这更符合面向对象编程的直觉。

## 原型链

原型链时由一系列对象的[[Prototype]]链接组成的查找机制。由于原型对象本身也是一个对象，它自己也有[[Prototype]]指向另一个原型对象，这样逐级向上形成链式结构就时**原型链**。

当查找一个属性时，引擎会沿着这条链一直向上查找，直到该属性或到达链的尽头(null)，从而实现多层继承。

> [!tip]
>
> 所有对象的原型最终都指向`Object.prototype`